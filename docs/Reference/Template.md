# テンプレートリファレンス
## この文書について
この文書は、Anygetで小説を編集する際に使用される、**テンプレート**について解説する物です。

テンプレートについての基本的な解説は、チュートリアル部の「[テンプレートについて](../Tutorial/03_Template.md)」に記載されています。

## テンプレート記法

テンプレート記法には以下の種類があります。

- `$...$`：一行変数
    - 改行禁止の変数
- `|...|`：複数行変数
    - 改行可能の変数
- `%...%`：ラベル
    - 後述
- `\...`：エスケープ
    - 後の1文字をエスケープし、テンプレート記法として読み取られなくする
- `//...`：コメント
    - 行頭に置くことでその行をテンプレートとして保存されなくする

同じ名前の変数やラベルを複数個宣言した場合、それらは**同期**の対象になり、どれか一つを編集することで同じメッセージ内のそれ以外の物もすべて変化するようになります。

## ラベルについて
ラベルは、字の文と変数**両方の特性**を持つ存在です。基本的に文字列を入力することはできず、字の文のように固定されて振る舞いますが、一方でその内容は不変ではなく、例えば後述の「ラベルの詳細設定」から監視対象の変数を選択すれば、その変数の内容に応じて変化するようにすることもできます。

## テンプレートの関連設定

「変数の詳細設定」パネルや「ラベルの詳細設定」パネルなどで、テンプレートで定義した諸々の存在に対し個別で設定を行うことができます。

全てのテンプレートから存在を消去しても、変数本体は消えずに残り続け、これらの設定の対象として使用できます。
### 変数の詳細設定

「変数の詳細設定」パネルから、登録した変数について設定を行えます。

設定により対象となる変数は異なり、一行変数でしか使えない設定、複数行変数でしか使えない設定、両方で使える設定があります。

#### 増加幅  
**両方可**

「番号」などの変数向けの設定です。「投稿の追加」ボタンを押すたびに、設定された値が入力欄の変数に**加算**されます。マイナスの値を設定すれば減算も可能です。**数字**にしか加算は行われません。
#### 巻き戻し
**両方可**

「増加幅」設定の追加オプションです。チェックを入れることで、「増加幅」の基本的な効果に加え、投稿を削除するたびに、「増加幅」に設定された値が入力欄の変数から**減算**されます。
#### アンカー  
**一行変数限定**

チェックボックスをオンにしたうえでテキストボックスに文字列を入力することで**アンカー**を設定できます。

これは「特定の変数の直前に置くことでリンクを作ったりツールチップを表示したりできる」というもので、メインパネル「プレビュー」モードと「簡易プレビュー」パネル限定で使用できます。

例えば変数`number`のアンカーに`>>`を設定すればアンカー呼び出しが可能になりますし、変数`id`のアンカーに`id:`を設定すれば「id:KW2jqwoi君自演バレバレですよｗ」といった投稿を挟んだ際具体的にどんなことをしているか確認できます。

本文中に10000個以上存在するアンカーは弾かれます。

#### 固定する  
**両方可**

設定した変数は、投稿の削除や並び替えの影響を受けず、その場に**固定され続け**ます。「ここに投稿を挿入したいが、そうすると番号がずれてしまう」という状況には、番号に該当する変数を固定することで対処が可能です。
#### 入力候補 
**一行変数限定**

設定すると、「変数特定値メモ」で観測した値に基づいてテキストボックスフォーカス時に**入力候補**を表示します。

「変数特定値メモ」が更新されなければ、候補の内容も更新されません。

### ラベルの詳細設定

「ラベルの詳細設定」パネルから、登録したラベルについて設定を行えます。

ラベルの設定においては、まず**監視対象**となる変数をプルダウンメニューから設定します。これによりラベルは対象の変数と紐づけられ、影響し合う関係になります。

#### もし○○なら△△ でなければ□□

監視対象の変数の内容を参照し、「○○」に入力した文字列と一致するならラベルの内容を「△△」に、一致しないならば「□□」にする設定です。

デフォルトでは、□□にはラベルの宣言時に使われた名前がそのまま入ります。

#### クリックで増加

ラベルをクリックすることで、監視対象の変数の内容を指定した数だけ増加させます。

変数の内容が数値として解釈できるか、または空欄であるかしない場合、増加処理は行われません。